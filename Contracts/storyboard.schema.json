{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bxlstnrd.local/schemas/storyboard.schema.json",
  "title": "Storyboard",
  "type": "object",
  "required": ["scenes"],
  "additionalProperties": false,
  "properties": {
    "scenes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "scene_id",
          "start",
          "end",
          "structure_type",
          "energy",
          "cast",
          "visual_intent",
          "camera_language",
          "environment",
          "symbolic_elements",
          "prompt_base"
        ],
        "additionalProperties": false,
        "properties": {
          "scene_id": { "type": "string", "minLength": 2 },
          "start": { "type": "number", "minimum": 0 },
          "end": { "type": "number", "minimum": 0 },

          "structure_type": {
            "type": "string",
            "enum": ["intro", "verse", "prechorus", "chorus", "bridge", "breakdown", "outro", "instrumental"]
          },
          "energy": { "type": "number", "minimum": 0, "maximum": 1 },

          "cast": {
            "type": "array",
            "minItems": 0,
            "items": { "type": "string", "minLength": 1 }
          },

          "visual_intent": { "type": "string", "minLength": 1 },
          "camera_language": { "type": "string", "minLength": 1 },
          "environment": { "type": "string", "minLength": 1 },
          "symbolic_elements": {
            "type": "array",
            "items": { "type": "string" }
          },

          "prompt_base": { "type": "string", "minLength": 1 },

          "user_notes": { "type": "string" },

          "render": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "status": { "type": "string", "enum": ["none", "queued", "done", "error"], "default": "none" },
              "image_url": { "type": ["string", "null"] },
              "seed": { "type": ["integer", "null"] },
              "model": { "type": ["string", "null"] },
              "error": { "type": ["string", "null"] }
            }
          }
        }
      }
    }
  }
}
