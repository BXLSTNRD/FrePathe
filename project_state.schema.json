{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bxlstnrd.local/schemas/project_state.schema.json",
  "title": "ProjectState",
  "type": "object",
  "required": ["project", "audio_dna", "cast", "storyboard"],
  "additionalProperties": false,
  "properties": {
    "project": {
      "type": "object",
      "required": ["id", "title", "style_preset", "aspect"],
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 8 },
        "title": { "type": "string" },
        "style_preset": { "type": "string", "minLength": 1 },
        "aspect": { "type": "string", "enum": ["square", "vertical", "horizontal"] },
        "subtitles": { "type": "boolean", "default": false },

        "seed_policy": { "type": "string", "enum": ["per_scene", "per_scene_and_cast"], "default": "per_scene_and_cast" },

        "render_models": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "image_model": { "type": "string", "default": "fal-ai/flux-1/dev" },
            "video_model": { "type": "string", "default": "" }
          }
        },

        "created_at": { "type": "string" },
        "updated_at": { "type": "string" }
      }
    },

    "audio_dna": { "$ref": "audio_dna.schema.json" },

    "cast": {
      "type": "array",
      "items": { "$ref": "visual_dna.schema.json" }
    },

    "storyboard": { "$ref": "storyboard.schema.json" }
  }
}
